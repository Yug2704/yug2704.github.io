<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Combien coûte une bouteille de lait ? Pays les moins et plus chers</title>
  <meta name="description" content="Classement du prix du lait (1 L) par pays en 2025 : où c’est le moins cher et le plus cher, avec liens vers chaque page pays.">
  <link rel="stylesheet" href="/assets/css/site.css" />
  <style>
    .hero{border-radius:14px;height:180px;margin:14px 0 18px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#fffdfd);border:1px solid #f1f5f9}
    .hero svg{opacity:.9}
    .intro{border:1px solid var(--line,#e5e7eb);border-radius:12px;padding:14px;background:#fff}
    .tables{display:grid;gap:18px;margin:18px 0}
    @media(min-width:1000px){.tables{grid-template-columns:1fr 1fr}}
    table{width:100%;border-collapse:collapse;background:#fff;border:1px solid var(--line,#e5e7eb);border-radius:12px;overflow:hidden}
    th,td{padding:10px 12px;border-bottom:1px solid var(--line,#e5e7eb);text-align:left}
    th{background:#f9fafb}
    tbody tr:last-child td{border-bottom:none}
    .badge{display:inline-block;background:#ef4444;color:#fff;font-weight:700;border-radius:999px;padding:.15rem .5rem;font-size:.85rem}
    .badge.green{background:#16a34a}
    .muted{color:var(--muted,#64748b)}
    .country-link{text-decoration:none;color:inherit}
    .country-link:hover{text-decoration:underline}
  </style>
  <script>
    const fmtEUR = n => (Math.round(n*100)/100).toLocaleString('fr-FR',{minimumFractionDigits:(Number.isInteger(n)?0:2)})+" €";
    async function include(sel,url){ const el=document.querySelector(sel); const r=await fetch(url,{cache:'no-store'}); el.outerHTML=await r.text(); }

    const MILK_KEY = "lait_1l";

    function trCountryRow(node,key){
      const price = node?.basket?.[MILK_KEY];
      if (price==null) return null;
      const slug = (node.slug || key);
      const to = `/cout-de-la-vie/${slug}/`;
      const minMax = (node.ranges && node.ranges[MILK_KEY])
        ? `${fmtEUR(node.ranges[MILK_KEY][0])} à ${fmtEUR(node.ranges[MILK_KEY][1])}`
        : "—";
      return `<tr>
        <td><a class="country-link" href="${to}">${node.name}</a></td>
        <td>${fmtEUR(price)}</td>
        <td>${minMax}</td>
      </tr>`;
    }

    async function bootstrap(){
      // Banner (SVG milk)
      const hero = document.querySelector('.hero');
      hero.innerHTML = `
        <svg width="120" height="150" viewBox="0 0 76 100" xmlns="http://www.w3.org/2000/svg" aria-label="Bouteille de lait">
          <defs><linearGradient id="g" x1="0" x2="0" y1="0" y2="1"><stop offset="0%" stop-color="#fff"/><stop offset="100%" stop-color="#f3f4f6"/></linearGradient></defs>
          <path d="M22 20h32c2 0 3 2 2 4l-5 8v56c0 5-4 9-9 9H34c-5 0-9-4-9-9V32l-5-8c-1-2 0-4 2-4z" fill="url(#g)"/>
          <path d="M22 20h32m-34 0c-2 0-3 2-2 4l5 8v56c0 5 4 9 9 9h8c5 0 9-4 9-9V32l5-8c1-2 0-4-2-4M27 32h22" fill="none" stroke="#111827" stroke-width="2"/>
        </svg>`;

      const res = await fetch('/data/locations.json',{cache:'no-store'});
      const db  = await res.json();

      const countries = Object.entries(db)
        .filter(([k,n]) => n && n.type === 'country' && n.basket && n.basket[MILK_KEY]!=null);

      const asc  = [...countries].sort((a,b)=> a[1].basket[MILK_KEY] - b[1].basket[MILK_KEY]);
      const desc = [...countries].sort((a,b)=> b[1].basket[MILK_KEY] - a[1].basket[MILK_KEY]);

      document.getElementById('tbody-cheap').innerHTML  = asc .slice(0,10).map(([k,n])=>trCountryRow(n,k)).filter(Boolean).join('');
      document.getElementById('tbody-pricey').innerHTML = desc.slice(0,10).map(([k,n])=>trCountryRow(n,k)).filter(Boolean).join('');

      document.getElementById('count-cheap').textContent  = asc.length;
      document.getElementById('count-pricey').textContent = desc.length;
    }
    document.addEventListener('DOMContentLoaded', bootstrap);
  </script>
</head>
<body>
  <div id="header-placeholder"></div>

  <main class="container">
    <div class="hero" role="img" aria-label="Catégorie Lait"></div>

    <h1>Combien coûte une bouteille de lait&nbsp;?</h1>
    <div class="intro">
      <p>Comparez le <strong>prix d’un litre de lait</strong> par pays. Retrouvez ci-dessous les classements des pays où le lait coûte le <strong>moins cher</strong> et où il coûte le <strong>plus cher</strong>. Cliquez sur un pays pour voir tous ses prix détaillés.</p>
    </div>

    <section class="tables">
      <div>
        <h2>Lait&nbsp;: les pays où cela coûte <span class="badge green">le moins cher</span></h2>
        <p class="muted">Classement basé sur <span id="count-cheap">—</span> pays avec données disponibles.</p>
        <table>
          <thead><tr><th>Pays</th><th>Prix moyen en 2025</th><th>Prix minimum et maximum</th></tr></thead>
          <tbody id="tbody-cheap"></tbody>
        </table>
      </div>

      <div>
        <h2>Lait&nbsp;: les pays où cela coûte <span class="badge">le plus cher</span></h2>
        <p class="muted">Classement basé sur <span id="count-pricey">—</span> pays avec données disponibles.</p>
        <table>
          <thead><tr><th>Pays</th><th>Prix moyen en 2025</th><th>Prix minimum et maximum</th></tr></thead>
          <tbody id="tbody-pricey"></tbody>
        </table>
      </div>
    </section>
  </main>

  <div id="footer-placeholder"></div>

  <script>
    include('#header-placeholder','/partials/header.html');
    include('#footer-placeholder','/partials/footer.html');
  </script>
</body>
</html>