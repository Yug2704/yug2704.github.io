<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Co√ªt de la vie au Japon en 2025 : tous les prix</title>
  <meta name="description" content="Prix moyens au Japon et comparaison avec la France : restaurant, boissons, loyer, salaire, etc. Donn√©es mises √† jour.">
  <meta property="og:title" content="Co√ªt de la vie au Japon en 2025" />
  <meta property="og:description" content="Comparatif avec la France et prix d√©taill√©s par panier de biens et services." />
  <link rel="canonical" href="." />
  <link rel="stylesheet" href="/assets/css/site.css" />
  <script>
    // util: charge un fragment HTML
    async function include(selector, url){
      const el = document.querySelector(selector);
      const res = await fetch(url,{cache:'no-store'});
      el.outerHTML = await res.text();
    }
    // util: format prix
    const fmtEUR = (n)=> (Math.round(n*100)/100).toLocaleString('fr-FR',{minimumFractionDigits: (Number.isInteger(n)?0:2)}) + " ‚Ç¨";
    // util: % √©cart
    function pctDiff(v, ref){
      if (!ref || ref===0) return null;
      const p = Math.round(((v - ref)/ref)*100);
      return {p, label: p===0 ? "identique" : (p<0 ? `${Math.abs(p)}% de moins` : `${p}% de plus`), cls: (p<=0?'ok':'bad')};
    }
    // map libell√©s
    const LABELS = {
      "dejeuner_restaurant": ["D√©jeuner","Prix d‚Äôun repas au restaurant"],
      "diner_3plats": ["D√Æner 3 plats","Prix d‚Äôun d√Æner au restaurant (3 plats)"],
      "menu_fastfood": ["Menu McDo / fast-food","Prix d‚Äôun menu chez McDonald‚Äôs (ou √©quivalent)"],
      "biere_locale_05": ["Bi√®re locale (0,5 L)","Prix d‚Äôune bi√®re pression (0,5 L)"],
      "biere_etrangere_033": ["Bi√®re √©trang√®re (0,33 L)","Prix d‚Äôune bi√®re en bouteille (0,33 L)"],
      "cappuccino": ["Cappuccino","Prix d‚Äôune tasse de cappuccino"],
      "soda_canette": ["Soda (canette)","Prix d‚Äôune canette de soda"],
      "eau_petite": ["Bouteille d‚Äôeau (petite)","Prix d‚Äôune petite bouteille d‚Äôeau"]
    };
  </script>
</head>
<body>
  <!-- Header partag√© -->
  <div id="header-placeholder"></div>

  <main>
    <section class="page-hero">
      <div class="container">
        <nav aria-label="Fil d‚ÄôAriane" class="muted" style="font-size:13px">
          <a href="/">Accueil</a> ‚Ä∫ <a href="/cout-de-la-vie/">Co√ªt de la vie</a> ‚Ä∫ <span id="crumb-name">Japon</span>
        </nav>
        <h1 id="page-title">Co√ªt de la vie au Japon en 2025 : tous les prix</h1>
        <p class="lead" id="page-lead">
          √Ä partir d‚Äôune soixantaine de prix moyens, d√©couvrez le co√ªt de la vie au Japon compar√© √† la France.
        </p>
      </div>
    </section>

    <section class="container">
      <div class="summary" id="summary">
        <div class="badge" id="headline"></div>
        <ul class="bullets" id="bullets">
          <!-- items inject√©s -->
        </ul>
        <small class="muted">üïí Derni√®re mise √† jour : <span id="last-update">‚Äî</span></small>
      </div>

      <div class="cards" id="cards">
        <!-- cartes inject√©es -->
      </div>
    </section>
  </main>

  <!-- Footer partag√© -->
  <div id="footer-placeholder"></div>

  <script>
    // Injecte header/footer
    include('#header-placeholder','/partials/header.html');
    include('#footer-placeholder','/partials/footer.html');

    // Lit le slug depuis l‚ÄôURL (/cout-de-la-vie/<slug>/)
    const slug = location.pathname.replace(/\/$/,'').split('/').pop() || 'japon';

    async function bootstrap(){
      const res = await fetch('/data/locations.json',{cache:'no-store'});
      const db = await res.json();

      const node = db[slug];
      if(!node){ document.getElementById('page-title').textContent = "Lieu introuvable"; return; }

      // Contexte FR de comparaison
      const ref = node.compare_to ? db[node.compare_to] : db['france'];

      // SEO/Title dynamiques
      const isCountry = node.type === 'country';
      const title = `Co√ªt de la vie ${isCountry?'au':'√†'} ${node.name} en 2025 : tous les prix`;
      document.title = title;
      document.getElementById('page-title').textContent = title;
      document.getElementById('crumb-name').textContent = node.name;

      // Headline
      const head = document.getElementById('headline');
      if (node.headline && typeof node.headline.delta_vs_france_pct === 'number'){
        const d = node.headline.delta_vs_france_pct;
        head.textContent = (d>=0?`+${d}%`:`${d}%`) + " vs France (moyenne)";
      } else {
        head.textContent = "Comparatif avec la France";
      }

      // Bullets de r√©sum√© (exemple adapt√©s √† tes captures)
      const bullets = document.getElementById('bullets');
      bullets.innerHTML = "";
      const items = [];
      if (node.meta?.salaire_mensuel_net) items.push(`Le salaire mensuel net est de : <strong>${fmtEUR(node.meta.salaire_mensuel_net)}</strong>`);
      if (node.meta?.dejeuner_moins_cher) items.push(`Un d√©jeuner au restaurant : <strong>${fmtEUR(node.meta.dejeuner_moins_cher)}</strong>`);
      if (node.meta?.place_de_cinema) items.push(`Le prix d‚Äôune place de cin√©ma est de <strong>${fmtEUR(node.meta.place_de_cinema)}</strong>`);
      if (node.meta?.loyer_centre_ville_50m2) items.push(`La location d‚Äôun 50 m¬≤ en centre-ville co√ªte <strong>${fmtEUR(node.meta.loyer_centre_ville_50m2)}</strong>`);
      if (node.headline?.resume) items.unshift(node.headline.resume);
      bullets.innerHTML = items.map(x=>`<li>${x}</li>`).join("");

      // Date MAJ (expos√©e au footer si besoin)
      const last = node.last_update || new Date().toLocaleDateString('fr-FR');
      document.getElementById('last-update').textContent = last;
      window.__pageLastUpdate = last;

      // Cartes ‚Äúrestaurant / boissons‚Äù √† la fa√ßon du screen
      const cards = document.getElementById('cards');
      cards.innerHTML = "";
      const order = ["dejeuner_restaurant","diner_3plats","menu_fastfood","biere_locale_05","biere_etrangere_033","cappuccino","soda_canette","eau_petite"];
      order.forEach(key=>{
        if(!(key in node.basket)) return;
        const [title, subtitle] = LABELS[key] || [key,key];
        const val = node.basket[key];
        const base = ref?.basket?.[key];
        const diff = (base!=null) ? pctDiff(val, base) : null;

        const el = document.createElement('article');
        el.className = 'card';
        el.innerHTML = `
          <div class="card-head">${title}</div>
          <div class="card-body">
            <div class="price">${fmtEUR(val)}</div>
            <div class="sub">${subtitle} en ${node.name} (2025)</div>
            ${
              (base!=null && diff) ?
              `<div class="delta ${diff.cls}">‚Ü≥ ${diff.label} (France : ${fmtEUR(base)})</div>`
              : ``
            }
          </div>`;
        cards.appendChild(el);
      });
    }
    bootstrap();
  </script>
</body>
</html>
