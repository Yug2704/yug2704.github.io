---
import AreaPage from "../../components/AreaPage.astro";

// ðŸ§­ On prÃ©-gÃ©nÃ¨re TOUT : les slugs des pays ET des villes
export async function getStaticPaths() {
  const countryMods = import.meta.glob("../../data/countries/*.json");
  const cityMods = import.meta.glob("../../data/cities/*.json");

  const countrySlugs = Object.keys(countryMods).map((p) => p.split("/").pop().replace(".json", ""));
  const citySlugs = Object.keys(cityMods).map((p) => p.split("/").pop().replace(".json", ""));
  const all = Array.from(new Set([...countrySlugs, ...citySlugs]));

  return all.map((slug) => ({ params: { slug } }));
}

// ðŸš¦ Charge dâ€™abord le JSON pays ; sinon bascule sur le JSON ville
const { slug } = Astro.params;

let data;
try {
  data = (await import(`../../data/countries/${slug}.json`)).default;
} catch {
  data = (await import(`../../data/cities/${slug}.json`)).default;
}

---
<AreaPage data={data} />
