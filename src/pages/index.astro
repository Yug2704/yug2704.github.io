---
import BaseLayout from "../layouts/BaseLayout.astro";
const title = "Prix de la vie â€“ Accueil";
---
<BaseLayout title={title}>
  <!-- BanniÃ¨re -->
  <div class="banner" style="margin:18px 0;border:1px solid var(--line);border-radius:18px;overflow:hidden;box-shadow:var(--shadow);">
    <img src="/banners/monde.jpg" alt="BanniÃ¨re" style="width:100%;height:220px;object-fit:cover;" />
  </div>

  <!-- Banderole rose + recherche -->
  <div style="position:relative;margin-top:-22px;padding:10px 0;">
    <div aria-hidden="true" style="
      position:absolute;inset:0;height:64px;margin:auto;left:8px;right:8px;
      background:linear-gradient(90deg,#ffc2d5,#ff8db2,#ffc2d5);
      border-radius:999px;filter:blur(10px) saturate(1.1);opacity:.7;z-index:0;"></div>

    <div style="position:relative;z-index:1;display:flex;gap:8px;align-items:center;background:#fff;border:1px solid var(--line);border-radius:999px;padding:10px 12px;box-shadow:var(--shadow);">
      <input id="q" placeholder="Rechercher (ex: Japon, Tokyo, Lait, Japon-lait)" style="flex:1;background:transparent;border:none;outline:none;color:var(--text);" />
      <a class="btn" id="go" href="#">Rechercher</a>
    </div>
  </div>

  <!-- Bloc intro amÃ©liorÃ© -->
  <section class="intro-card">
    <div class="intro-head">
      <h2>Bienvenue sur <span>Prix de la vie</span></h2>
      <button class="info-badge" id="homeInfoBtn" aria-expanded="false" aria-controls="homeInfo">
        En savoir +
      </button>
    </div>

    <p class="lead">
      Compare les coÃ»ts du quotidien dans des dizaines de pays et de villes, avec une rÃ©fÃ©rence
      commune : <strong>la France</strong>. En un coup dâ€™Å“il, tu vois comment Ã©voluent les
      <em>repas</em>, <em>loyers</em>, <em>transports</em>, <em>loisirs</em> ou encore lâ€™
      <em>hÃ©bergement</em> selon les destinations.
    </p>

    <p class="micro">
      Les montants affichÃ©s sont des <strong>moyennes indicatives</strong> : ils aident Ã  se situer rapidement,
      Ã  prÃ©parer un voyage, une expatriation ou un budget. Les valeurs peuvent varier selon la ville et la saison.
    </p>

    <!-- Fiche contextuelle -->
    <div class="popover" id="homeInfo" role="dialog" aria-label="Ã€ propos de Prix de la vie">
      <div class="pop-inner">
        <h3>Ce que tu trouveras ici</h3>
        <ul>
          <li><strong>Comparaison directe</strong> des prix vs France pour mieux se repÃ©rer.</li>
          <li><strong>Indicateurs clairs</strong> : repas, loyer centre-ville, essence, cinÃ©ma, hÃ´tel, etc.</li>
          <li><strong>Pages pays & villes</strong> pour des repÃ¨res concrets et rapides.</li>
          <li><strong>Mises Ã  jour</strong> centralisÃ©es via des donnÃ©es structurÃ©es.</li>
        </ul>
        <p class="hint">
          Astuce : utilise la recherche pour accÃ©der directement Ã  un pays (<em>Japon</em>) ou une ville (<em>Tokyo</em>).
        </p>
      </div>
    </div>
  </section>

  <!-- CatÃ©gories (ajout avec les nouvelles) -->
  <section style="margin-top:16px;">
    <h3 style="margin:0 0 10px 0;">Parcourir par catÃ©gorie</h3>
    <div class="chips">
      <a class="chip" href="/category/restaurant">ğŸ½ï¸ Repas</a>
      <a class="chip" href="/category/salaire">ğŸ’° Salaire net</a>
      <a class="chip" href="/category/loyer">ğŸ  Loyer</a>
      <a class="chip" href="/category/essence">â›½ Essence</a>
      <a class="chip" href="/category/cigarettes">ğŸš¬ Cigarettes</a>
      <a class="chip" href="/category/cinema">ğŸ¬ CinÃ©ma</a>
      <a class="chip" href="/category/hotel">ğŸ›ï¸ HÃ´tel</a>
      <a class="chip" href="/category/habiter">ğŸ¡ Indice â€œHabiterâ€</a>
      <!-- nouvelles catÃ©gories -->
      <a class="chip" href="/category/eau1l">ğŸ’§ Eau (1 L)</a>
      <a class="chip" href="/category/transportLocal">ğŸš Transports locaux</a>
      <a class="chip" href="/category/billetAvion">âœˆï¸ Billet dâ€™avion A/R</a>
      <a class="chip" href="/category/train">ğŸš† Train interurbain</a>
      <a class="chip" href="/category/forfaitMobile">ğŸ“± Forfait mobile</a>
    </div>
  </section>

  <style>
    .intro-card{
      position:relative;background:#fff;border:1px solid #ffd0df;border-radius:18px;
      padding:18px 18px 20px;margin:18px 0 6px;box-shadow:0 10px 28px rgba(17,24,39,.06), 0 2px 10px rgba(255,77,141,.06)
    }
    .intro-head{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:6px}
    .intro-card h2{margin:0;font-size:1.45rem}
    .intro-card h2 span{color:#a61b4d}
    .lead{margin:.35rem 0 .4rem 0;line-height:1.65}
    .micro{color:var(--muted);line-height:1.65;margin:.25rem 0 0 0}
    .info-badge{border:1px solid #ffd0df;background:#fff;border-radius:999px;padding:.42rem .75rem;font-size:.95rem;color:#a61b4d;box-shadow:var(--shadow);cursor:pointer}
    .info-badge:hover{background:#fff1f6}
    .popover{
      position:absolute;right:12px;top:100%;transform:translateY(10px);
      width:min(680px,calc(100% - 24px));background:#fff;border:1px solid #ffd0df;border-radius:16px;
      box-shadow:0 12px 24px rgba(17,24,39,.10);opacity:0;pointer-events:none;transition:opacity .18s,transform .18s;z-index:5
    }
    .intro-card:hover .popover,.info-badge:focus + .popover,.popover.open{opacity:1;pointer-events:auto;transform:translateY(6px)}
    .pop-inner{padding:14px 16px}
    .pop-inner h3{margin:.2rem 0 .35rem 0;font-size:1.05rem}
    .pop-inner ul{margin:.25rem 0 .5rem 1.15rem}
    .pop-inner li{margin:.25rem 0;line-height:1.5}
    .hint{color:var(--muted);margin:0}
  </style>

  <script>
    const q = document.getElementById('q');
    const go = document.getElementById('go');
    function openBestMatch(){
      const term = (q.value||"").toLowerCase().trim();
      if(!term) return;
      if(term.includes('-')){ const [a,b] = term.split('-'); location.href = `/country/${a}/${b}`; return; }
      fetch(`/country/${term}/index.html`, {method:'HEAD'}).then(r=>{
        if(r.ok) location.href = `/country/${term}`;
        else location.href = `/category/${term}`;
      }).catch(()=> location.href = `/category/${term}`);
    }
    go.addEventListener('click', e=>{e.preventDefault();openBestMatch();});
    q.addEventListener('keydown', e=>{if(e.key==='Enter')openBestMatch();});

    const btn = document.getElementById('homeInfoBtn');
    const pop = document.getElementById('homeInfo');
    if (btn && pop){
      btn.addEventListener('click', (e)=>{
        e.preventDefault();
        const opened = pop.classList.toggle('open');
        btn.setAttribute('aria-expanded', opened ? 'true' : 'false');
      });
      document.addEventListener('click', (evt)=>{
        if (!pop.classList.contains('open')) return;
        const t = evt.target;
        if (!pop.contains(t) && t !== btn){ pop.classList.remove('open'); btn.setAttribute('aria-expanded','false'); }
      });
    }
  </script>
</BaseLayout>
