---
// (imports conserv√©s si tu en as besoin autre part ; ils ne cassent rien m√™me si non utilis√©s)
import cities from "../data/_index_cities.json";
import countries from "../data/_index_countries.json";

const {
  title = "Prix de la vie",
  description = "Comparez les prix par pays et par cat√©gories ‚Äî toujours vs France."
} = Astro.props;
---
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <style>
      :root{
        --bg:#ffffff;
        --text:#111827;
        --muted:#4b5563;
        --line:#e5e7eb;
        --card:#ffffff;
        --shadow:0 6px 18px rgba(17,24,39,.06);
        --accent:#ff4d8d;
        --accent-600:#ef437f;
        --accent-100:#fff1f6;
        --footer-bg:#fff1f6;
        --footer-strong:#ff8db2;
        --footer-strong-2:#ff6a9c;
      }

      *{box-sizing:border-box}
      html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
      a{color:inherit;text-decoration:none}
      .container{max-width:1100px;margin:0 auto;padding:16px}

      header {
        position: sticky; top: 0;
        background: linear-gradient(90deg, #fff5f9 0%, #ffffff 50%, #fff5f9 100%);
        backdrop-filter: saturate(1.2) blur(8px);
        border-bottom: 2px solid #ffd0df;
        box-shadow: 0 2px 12px rgba(255, 128, 171, 0.1);
        z-index: 10;
      }
      header .container a:first-child { color: #a61b4d; font-weight: 700; }

      .pill { background:#fff;border:1px solid #ffd0df;border-radius:999px;padding:6px 12px;color:#a61b4d;transition:all .15s }
      .pill:hover { background:#ffe4ec;border-color:#ffb4c8 }

      .search { display:flex;align-items:center;gap:8px }
      .search input { border:1px solid #ffd0df;border-radius:999px;padding:6px 12px;outline:none }
      .search input:focus { border-color:#ff8db2; box-shadow:0 0 0 2px #ffdee9 }

      .grid{display:grid;gap:14px;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
      .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
      .btn{display:inline-block;padding:.65rem 1rem;border-radius:999px;background:var(--accent);color:#fff;border:1px solid transparent;box-shadow:0 2px 12px rgba(255,128,171,.1)}
      .btn:hover{background:var(--accent-600)}
      code{background:#f8fafc;border:1px solid var(--line);border-radius:6px;padding:2px 6px}

      .chips{display:flex;flex-wrap:wrap;gap:10px;margin-top:14px}
      .chip{display:inline-block;padding:8px 12px;border-radius:999px;background:var(--accent-100);color:#a61b4d;border:1px solid #ffd0df;font-size:.95rem;box-shadow:var(--shadow);transition:all .15s}
      .chip:hover{filter:brightness(1.05);transform:translateY(-1px)}

      .site-bottom{margin-top:36px}
      .site-bottom .info{background:var(--footer-bg);border-top:1px solid #ffd0df;border-bottom:1px solid #ffd0df}
      .info-inner{display:grid;gap:22px;grid-template-columns:1.2fr .8fr;align-items:start;padding:28px 16px}
      .info h3{margin:0 0 8px}
      .info p{color:var(--muted);line-height:1.65;margin:0}
      .links ul{list-style:none;margin:8px 0 0;padding:0}
      .links li{margin:6px 0}
      .links a{color:#a61b4d}
      .links a:hover{text-decoration:underline}

      .footer-strong{background:linear-gradient(0deg,var(--footer-strong),var(--footer-strong-2));color:#fff}
      .footer-strong-inner{display:flex;justify-content:space-between;align-items:center;gap:12px;padding:16px}
      .footer-strong a{color:#fff;background:rgba(255,255,255,.15)}
    </style>
  </head>
  <body>
    <header>
      <div class="container" style="display:flex;justify-content:space-between;align-items:center;height:64px;gap:12px;">
        <a href="/" style="font-weight:700">Prix de la vie</a>
        <nav style="display:flex;gap:12px;align-items:center;">
          <a class="pill" href="/">Accueil</a>
          <a class="pill" href="/category/restaurant">Toutes cat√©gories</a>

          <!-- üîé Recherche header ‚Äì m√™me logique que la grande barre -->
          <div class="search" role="search" aria-label="Recherche">
            <input
              id="hdr-q"
              type="search"
              placeholder="Pays ou ville‚Ä¶"
              autocomplete="off"
              aria-label="Rechercher un pays, une ville ou pays-cat√©gorie"
            />
            <button class="pill" type="button" id="hdr-go">Chercher</button>
          </div>
        </nav>
      </div>
    </header>

    <main class="container">
      <slot />
    </main>

    <section class="site-bottom">
      <div class="info">
        <div class="container info-inner">
          <div>
            <h3>√Ä propos</h3>
            <p>
              Prix de la vie compare des prix de biens et services dans diff√©rents pays et villes,
              avec une r√©f√©rence claire : la France. Parcourez nos pages pour obtenir des rep√®res concrets
              (repas, loyers, transports, produits du quotidien) et pr√©parer un voyage, une expatriation ou un budget.
            </p>
          </div>
          <div class="links">
            <h3>Pages</h3>
            <ul>
              <li><a href="/">Accueil</a></li>
              <li><a href="/country/france">France</a></li>
              <li><a href="/sitemap.xml">Sitemap</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="footer-strong">
        <div class="container footer-strong-inner">
          <span>¬© {new Date().getFullYear()} Prix de la vie</span>
          <a class="pill" href="/sitemap.xml">sitemap</a>
        </div>
      </div>
    </section>

    <!-- üîß Script : copie fid√®le de la logique de index.astro -->
    <script is:inline>
      const hdrQ  = document.getElementById('hdr-q');
      const hdrGo = document.getElementById('hdr-go');

      function openBestMatchHeader(){
        const termRaw = (hdrQ?.value || "").trim();
        if (!termRaw) return;
        const term = termRaw.toLowerCase();

        // pays-cat√©gorie (ex: japon-restaurants)
        if (term.includes('-')) {
          const [a,b] = term.split('-');
          window.location.href = `/country/${a}/${b}`;
          return;
        }

        // test si une page pays existe, sinon on bascule en /category/{term}
        fetch(`/country/${term}/index.html`, { method: 'HEAD' })
          .then(r => {
            if (r.ok) window.location.href = `/country/${term}`;
            else      window.location.href = `/category/${term}`;
          })
          .catch(() => window.location.href = `/category/${term}`);
      }

      hdrGo?.addEventListener('click', (e) => { e.preventDefault(); openBestMatchHeader(); });
      hdrQ?.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') { e.preventDefault(); openBestMatchHeader(); }
      });
    </script>
  </body>
</html>
