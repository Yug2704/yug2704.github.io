    <!-- ðŸ”§ Script recherche : capte TOUT, envoie toujours sur /country/<slug> -->
    <script is:inline>
      const CITIES = {JSON.stringify(cities)};
      const COUNTRIES = {JSON.stringify(countries)};

      const slugify = (s) =>
        String(s || "")
          .toLowerCase()
          .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
          .replace(/[^a-z0-9]+/g, "-")
          .replace(/(^-|-$)/g, "");

      function handleSearchSubmit(e) {
        const form = e.target;
        if (!(form instanceof HTMLFormElement)) return;

        // On cible seulement les formulaires ressemblant Ã  une recherche
        const isSearchRole = form.getAttribute("role") === "search";
        const hasQ = !!form.querySelector('input[name="q"]');
        const hasInput = !!form.querySelector('input[type="search"], input[type="text"]');
        if (!isSearchRole && !hasQ && !hasInput) return;

        e.preventDefault();

        let q = (new FormData(form).get("q")) || "";
        if (!q) {
          const input =
            form.querySelector('input[name="q"]') ||
            form.querySelector('input[type="search"]') ||
            form.querySelector('input[type="text"]');
          if (input) q = input.value || "";
        }

        const s = slugify(q);
        if (!s) { window.location.href = `/search?q=${encodeURIComponent(q)}`; return; }

        // 1) Ville connue â†’ /country/<slug> (la page saura charger le JSON ville)
        const city = CITIES.find(c => c.slug === s || slugify(c.name) === s);
        if (city) { window.location.href = `/country/${city.slug}`; return; }

        // 2) Pays connu â†’ /country/<slug>
        const country = COUNTRIES.find(c => c.slug === s || slugify(c.name) === s);
        if (country) { window.location.href = `/country/${country.slug}`; return; }

        // 3) Fallback rÃ©sultats
        window.location.href = `/search?q=${encodeURIComponent(q)}`;
      }

      // Intercepte toutes les soumissions en capture (devant /category/â€¦)
      document.addEventListener("submit", handleSearchSubmit, true);

      // SÃ©curise le fallback des formulaires marquÃ©s search
      document.querySelectorAll('form[role="search"]').forEach((f) => {
        if (!f.getAttribute('action')) f.setAttribute('action', '/search');
        if (!f.getAttribute('method')) f.setAttribute('method', 'GET');
      });
    </script>
