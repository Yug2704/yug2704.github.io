<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Prix de la vie ‚Äì comparateur par pays et villes</title>
  <meta name="description" content="Comparez le co√ªt de la vie par pays et par ville : repas, loyers, transports, cigarettes. Montants en euros.">
  <link rel="stylesheet" href="/assets/style.css">
  <style>
    .hero{background:linear-gradient(120deg,#f59e0b 0%, #ea580c 60%);color:#fff;padding:48px 16px;text-align:center}
    .hero h1{font-size:38px;margin:0}
    .hero p{max-width:720px;margin:12px auto 0;font-size:18px;line-height:1.55}
    .searchbox{margin-top:22px;display:flex;justify-content:center;gap:10px;flex-wrap:wrap}
    .searchbox input,.searchbox select{padding:12px 14px;border:1px solid var(--line);border-radius:10px;font-size:15px;width:240px}
    .searchbox button{background:#fff;color:#ea580c;border:2px solid #fff;padding:12px 22px;border-radius:12px;font-weight:700;cursor:pointer;transition:.15s}
    .searchbox button:hover{background:#fff7ed;color:#b45309;border-color:transparent}
    .results{max-width:760px;margin:26px auto 0;text-align:left}
    .summary{background:#fff7ed;border:1px solid #fed7aa;border-radius:14px;padding:14px}
    .kpis{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:10px}
    .kpi{background:#fff;border:1px solid var(--line);border-radius:12px;padding:10px}
    .kpi strong{display:block}
    .note{font-size:13px;color:var(--muted);margin-top:6px}
    .fade-in{animation:fadeIn .25s ease}@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}
  </style>

  <!-- AdSense (remplace par ton client si besoin) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXX" crossorigin="anonymous"></script>
  <!-- GA4 (remplace par ton ID) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-XXXXXXXXXX');</script>
</head>
<body>

<header class="topbar">
  <div class="topbar-inner">
    <a class="brand" href="/">Prix de la vie</a>
    <nav class="nav">
      <a href="/">Accueil</a>
      <a href="#categories">Cat√©gories</a>
      <a href="#recherche">Recherche</a>
    </nav>
  </div>
</header>

<section class="hero" id="recherche">
  <h1>Comparez le co√ªt de la vie üåç</h1>
  <p>Entrez un <strong>pays</strong> (ex. Japon, France) pour voir un r√©sum√© national, ou une <strong>ville</strong> (ex. Tokyo, Paris) pour ses prix d√©taill√©s. Montants en euros.</p>

  <div class="searchbox">
    <input id="searchInput" type="text" placeholder="Exemples : Japon, France, Tokyo, Paris‚Ä¶">
    <select id="filterSelect">
      <option value="all">Toutes cat√©gories</option>
      <option value="restaurant">Repas au restaurant</option>
      <option value="logement">Loyer</option>
      <option value="transport">Transport</option>
      <option value="tabac">Cigarettes</option>
    </select>
    <button id="searchBtn">Rechercher</button>
  </div>

  <div id="results" class="results"></div>
</section>

<main class="container">
  <h2 id="categories">Cat√©gories</h2>
  <div class="grid g3">
    <a class="card" href="/categories/restaurant.html"><strong>Repas au restaurant</strong></a>
    <a class="card" href="/categories/logement.html"><strong>Loyer (1 chambre centre)</strong></a>
    <a class="card" href="/categories/transport.html"><strong>Ticket de bus</strong></a>
    <a class="card" href="/categories/tabac.html"><strong>Cigarettes (paquet)</strong></a>
  </div>

  <!-- Section ‚ÄúPays‚Äù retir√©e car tu ne veux pas qu‚Äôils soient cliquables ;
       ils restent accessibles uniquement via la recherche. -->
</main>

<footer class="footer">
  <div class="container muted">¬© 2025 Prix de la vie ‚Äî Tous les montants exprim√©s en euros pour comparaison mondiale.</div>
</footer>

<!-- Donn√©es -->
<script src="/assets/data.js"></script>

<!-- Logique de recherche -->
<script>
function el(tag, cls, html){ const e=document.createElement(tag); if(cls) e.className=cls; if(html!=null) e.innerHTML=html; return e;}
function fmtVal(key,val){ if(val==null) return "‚Äî"; return (key==="logement") ? `${val} ‚Ç¨/mois` : `${val} ‚Ç¨`; }

function renderCountry(country, filter){
  const box = el("div","summary fade-in");
  box.appendChild(el("div",null,`<strong>${country.name}</strong> ‚Äî ${country.summary}`));
  const labels={restaurant:"Repas au restaurant",logement:"Loyer (1 chambre centre)",transport:"Ticket de bus",tabac:"Cigarettes (paquet)"};
  const keys=["restaurant","logement","transport","tabac"];
  const kpis = el("div","kpis");
  keys.forEach(k=>{ if(filter!=="all" && k!==filter) return;
    kpis.appendChild(el("div","kpi",`<strong>${labels[k]}</strong><div class="muted">${fmtVal(k,country.values?.[k])}</div>`));
  });
  box.appendChild(kpis);
  if(country.cities?.length){
    const links = country.cities.map(c=>`<a href="/city.html#${c.slug}">${c.name}</a>`).join(" ¬∑ ");
    box.appendChild(el("div","note",`√Ä voir dans les villes : ${links}`));
  }
  return box;
}

function renderCity(city, filter){
  const box = el("div","summary fade-in",`<div><strong>${city.name}</strong> ‚Äî Prix par cat√©gories</div>`);
  const labels={restaurant:"Repas au restaurant",logement:"Loyer (1 chambre centre)",transport:"Ticket de bus",tabac:"Cigarettes (paquet)"};
  const keys=["restaurant","logement","transport","tabac"];
  const grid = el("div","kpis");
  keys.forEach(k=>{ if(filter!=="all" && k!==filter) return;
    grid.appendChild(el("div","kpi",`<strong>${labels[k]}</strong><div class="muted">${fmtVal(k,(city.values||{})[k])}</div>`));
  });
  box.appendChild(grid);
  box.appendChild(el("div","note",`Page ville : <a href="/city.html#${city.slug||city.name.toLowerCase()}">${city.name}</a>`));
  return box;
}

function search(){
  const term = document.getElementById("searchInput").value.trim().toLowerCase();
  const filter = document.getElementById("filterSelect").value;
  const results = document.getElementById("results"); results.innerHTML = "";
  if(!term) return;

  // D‚Äôabord pays (r√©sum√© national)‚Ä¶
  const ctry = (window.DATA.countries||[]).find(c=>c.name.toLowerCase()===term)
            || (window.DATA.countries||[]).find(c=>c.name.toLowerCase().includes(term));
  if(ctry){ results.appendChild(renderCountry(ctry,filter)); return; }

  // ‚Ä¶sinon ville
  const city = (window.DATA.cities||[]).find(v=>v.name.toLowerCase()===term)
            || (window.DATA.cities||[]).find(v=>v.name.toLowerCase().includes(term));
  if(city){ results.appendChild(renderCity(city,filter)); return; }

  results.appendChild(el("p","muted fade-in","Aucun r√©sultat trouv√©."));
}

document.getElementById("searchBtn").addEventListener("click", search);
document.getElementById("searchInput").addEventListener("keydown",(e)=>{ if(e.key==="Enter") search(); });
</script>

</body>
</html>
